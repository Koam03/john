<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Assets</title>
    <style>
        /* Reset and Base Styles */
        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            font-family: 'Press Start 2P', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom, rgb(1,32,78), rgb(2,131,147));
            color: #fff;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        header {
            text-align: center;
            padding: 20px;
            background: rgb(246,86,37);
        }

        header h1 {
            margin: 0;
            font-size: 1.5rem;
        }

        .container {
            display: grid;
            gap: 10px;
            padding: 20px;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            flex: 1;
            overflow-y: auto;
        }

        .asset {
            border: 2px solid rgb(250,170,104);
            border-radius: 8px;
            overflow: hidden;
            text-align: center;
            background: rgb(246,220,172);
            color: rgb(1,32,78);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .asset:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .asset img, .asset video, .asset audio {
            width: 100%;
            height: auto;
            display: block;
        }

        .asset p {
            margin: 10px 0;
            padding: 0 10px;
            font-size: 0.8rem;
            word-break: break-all;
        }

        footer {
            text-align: center;
            padding: 10px;
            background: rgb(183,0,206);
            color: rgb(248,0,177);
            position: relative;
            width: 100%;
        }

        .controls {
            text-align: center;
            padding: 10px 20px;
            background: rgba(0,0,0,0.1);
        }

        .controls button {
            padding: 10px 20px;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            background-color: rgb(250,170,104);
            color: rgb(1,32,78);
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }

        .controls button:hover {
            background-color: rgb(240,160,94);
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.2rem;
            }

            .container {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                padding: 15px;
            }

            .asset p {
                font-size: 0.7rem;
            }

            footer {
                font-size: 0.8rem;
            }

            .controls button {
                padding: 8px 16px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>My Asset Gallery</h1>
    </header>
    
    <div class="controls">
        <button id="selectDirBtn">Select Directory</button>
    </div>
    
    <main class="container">
        <!-- Assets will be dynamically loaded from the selected directory -->
        <p id="placeholderText">No directory selected. Please click "Select Directory" to view files.</p>
    </main>
    
    <footer>
        <p>&copy; 2024 My Asset Gallery</p>
    </footer>
    
    <script>
        // Allowed file extensions and their corresponding handlers
        const allowedExtensions = {
            images: ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'svg', 'ai', 'psd', 'xcf', 'blend', 'obj', 'fbx', 'stl'],
            videos: ['mp4', 'webm', 'mov', 'avi'],
            audio: ['mp3', 'wav', 'aac'],
            documents: ['pdf', 'docx', 'xlsx', 'pptx', 'txt'],
            archives: ['zip', 'rar', '7z']
        };

        const container = document.querySelector('.container');
        const selectDirBtn = document.getElementById('selectDirBtn');
        const placeholderText = document.getElementById('placeholderText');

        // Function to get file icon based on extension
        function getFileIcon(extension) {
            const icons = {
                'jpg': 'üì∑', 'jpeg': 'üì∑', 'png': 'üì∑', 'gif': 'üì∑', 'bmp': 'üì∑', 'tiff': 'üì∑', 'tif': 'üì∑', 'webp': 'üì∑',
                'svg': 'üñºÔ∏è', 'ai': 'üé®', 'psd': 'üé®', 'xcf': 'üé®', 'blend': 'üé®', 'obj': 'üõ†Ô∏è', 'fbx': 'üõ†Ô∏è', 'stl': 'üõ†Ô∏è',
                'mp4': 'üé¨', 'webm': 'üé¨', 'mov': 'üé¨', 'avi': 'üé¨',
                'mp3': 'üéµ', 'wav': 'üéµ', 'aac': 'üéµ',
                'pdf': 'üìÑ', 'docx': 'üìÑ', 'xlsx': 'üìÑ', 'pptx': 'üìÑ', 'txt': 'üìÑ',
                'zip': 'üì¶', 'rar': 'üì¶', '7z': 'üì¶'
            };
            return icons[extension] || 'üìÅ';
        }

        // Function to display files
        async function displayFiles(directoryHandle) {
            container.innerHTML = ''; // Clear existing content
            const fragment = document.createDocumentFragment();

            let files = [];
            try {
                for await (const entry of directoryHandle.values()) {
                    if (entry.kind === 'file') {
                        const ext = entry.name.split('.').pop().toLowerCase();
                        const isAllowed = Object.values(allowedExtensions).flat().includes(ext);
                        if (isAllowed) {
                            files.push(entry);
                        }
                    }
                }

                if (files.length === 0) {
                    container.innerHTML = '<p>No supported files found in the selected directory.</p>';
                    return;
                }

                for (const fileHandle of files) {
                    const file = await fileHandle.getFile();
                    const extension = file.name.split('.').pop().toLowerCase();
                    const assetDiv = document.createElement('div');
                    assetDiv.classList.add('asset');
                    assetDiv.setAttribute('tabindex', '0'); // Make it focusable for accessibility

                    // Create appropriate HTML based on file type
                    let mediaElement = '';
                    if (allowedExtensions.images.includes(extension)) {
                        const objectURL = URL.createObjectURL(file);
                        mediaElement = `<img src="${objectURL}" alt="${file.name}">`;
                    } else if (allowedExtensions.videos.includes(extension)) {
                        const objectURL = URL.createObjectURL(file);
                        mediaElement = `<video controls><source src="${objectURL}" type="video/${extension}">Your browser does not support the video tag.</video>`;
                    } else if (allowedExtensions.audio.includes(extension)) {
                        const objectURL = URL.createObjectURL(file);
                        mediaElement = `<audio controls><source src="${objectURL}" type="audio/${extension}">Your browser does not support the audio element.</audio>`;
                    } else if (allowedExtensions.documents.includes(extension)) {
                        mediaElement = `<p>${getFileIcon(extension)} ${file.name}</p>`;
                    } else if (allowedExtensions.archives.includes(extension)) {
                        mediaElement = `<p>${getFileIcon(extension)} ${file.name}</p>`;
                    } else {
                        mediaElement = `<p>${getFileIcon(extension)} ${file.name}</p>`;
                    }

                    assetDiv.innerHTML = `
                        ${mediaElement}
                        <p>${file.name}</p>
                    `;

                    // Click event to open the file
                    assetDiv.addEventListener('click', () => {
                        if (allowedExtensions.images.includes(extension) || allowedExtensions.videos.includes(extension) || allowedExtensions.audio.includes(extension)) {
                            // For media files, open in a new tab
                            const objectURL = URL.createObjectURL(file);
                            window.open(objectURL, '_blank');
                        } else {
                            // For documents and archives, download the file
                            const downloadLink = document.createElement('a');
                            downloadLink.href = URL.createObjectURL(file);
                            downloadLink.download = file.name;
                            document.body.appendChild(downloadLink);
                            downloadLink.click();
                            document.body.removeChild(downloadLink);
                        }
                    });

                    // Keyboard accessibility
                    assetDiv.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            assetDiv.click();
                        }
                    });

                    fragment.appendChild(assetDiv);
                }

                container.appendChild(fragment);
                placeholderText.style.display = 'none'; // Hide placeholder
            } catch (error) {
                console.error('Error displaying files:', error);
                container.innerHTML = '<p>Error loading files.</p>';
            }
        }

        // Function to handle directory selection
        async function selectDirectory() {
            try {
                // Prompt user to select a directory
                const directoryHandle = await window.showDirectoryPicker();
                if (directoryHandle) {
                    displayFiles(directoryHandle);
                }
            } catch (error) {
                if (error.name !== 'AbortError') {
                    console.error('Error selecting directory:', error);
                    alert('Failed to select directory.');
                }
                // If user cancels the dialog, do nothing
            }
        }

        // Event listener for the "Select Directory" button
        selectDirBtn.addEventListener('click', selectDirectory);

        // Initial setup: Check for File System Access API support
        if (!window.showDirectoryPicker) {
            alert('Your browser does not support the File System Access API. Please use a compatible browser like Google Chrome or Microsoft Edge.');
            selectDirBtn.disabled = true;
            selectDirBtn.textContent = 'Unsupported Browser';
        }
    </script>
</body>
</html>
